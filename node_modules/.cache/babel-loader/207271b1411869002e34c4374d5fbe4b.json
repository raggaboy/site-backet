{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport createConnector from \"../core/createConnector.js\";\nimport { getResults, getIndexId, hasMultipleIndices } from \"../core/indexUtils.js\"; // A context rule must consist only of alphanumeric characters, hyphens, and underscores.\n// See https://www.algolia.com/doc/guides/managing-results/refine-results/merchandising-and-promoting/in-depth/implementing-query-rules/#context\n\nfunction escapeRuleContext(ruleName) {\n  return ruleName.replace(/[^a-z0-9-_]+/gi, '_');\n}\n\nfunction getWidgetRefinements(attribute, widgetKey, searchState) {\n  var widgetState = searchState[widgetKey];\n\n  switch (widgetKey) {\n    case 'range':\n      return Object.keys(widgetState[attribute]).map(function (rangeKey) {\n        return widgetState[attribute][rangeKey];\n      });\n\n    case 'refinementList':\n      return widgetState[attribute];\n\n    case 'hierarchicalMenu':\n      return [widgetState[attribute]];\n\n    case 'menu':\n      return [widgetState[attribute]];\n\n    case 'multiRange':\n      return widgetState[attribute].split(':');\n\n    case 'toggle':\n      return [widgetState[attribute]];\n\n    default:\n      return [];\n  }\n}\n\nfunction getRefinements(attribute) {\n  var searchState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var refinements = Object.keys(searchState).filter(function (widgetKey) {\n    return searchState[widgetKey] !== undefined && searchState[widgetKey][attribute] !== undefined;\n  }).map(function (widgetKey) {\n    return getWidgetRefinements(attribute, widgetKey, searchState);\n  }).reduce(function (acc, current) {\n    return acc.concat(current);\n  }, []); // flatten the refinements\n\n  return refinements;\n}\n\nfunction getRuleContextsFromTrackedFilters(_ref) {\n  var searchState = _ref.searchState,\n      trackedFilters = _ref.trackedFilters;\n  var ruleContexts = Object.keys(trackedFilters).reduce(function (facets, facetName) {\n    var facetRefinements = getRefinements(facetName, searchState);\n    var getTrackedFacetValues = trackedFilters[facetName];\n    var trackedFacetValues = getTrackedFacetValues(facetRefinements);\n    return [].concat(_toConsumableArray(facets), _toConsumableArray(facetRefinements.filter(function (facetRefinement) {\n      return trackedFacetValues.includes(facetRefinement);\n    }).map(function (facetValue) {\n      return escapeRuleContext(\"ais-\".concat(facetName, \"-\").concat(facetValue));\n    })));\n  }, []);\n  return ruleContexts;\n}\n\nvar defaultProps = {\n  transformItems: function transformItems(items) {\n    return items;\n  },\n  transformRuleContexts: function transformRuleContexts(ruleContexts) {\n    return ruleContexts;\n  },\n  trackedFilters: {}\n};\nexport default createConnector({\n  displayName: 'AlgoliaQueryRules',\n  $$type: 'ais.queryRules',\n  defaultProps: defaultProps,\n  getProvidedProps: function getProvidedProps(props, _1, searchResults) {\n    var results = getResults(searchResults, {\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    });\n\n    if (results === null) {\n      return {\n        items: [],\n        canRefine: false\n      };\n    }\n\n    var _results$userData = results.userData,\n        userData = _results$userData === void 0 ? [] : _results$userData;\n    var transformItems = props.transformItems;\n    var transformedItems = transformItems(userData);\n    return {\n      items: transformedItems,\n      canRefine: transformedItems.length > 0\n    };\n  },\n  getSearchParameters: function getSearchParameters(searchParameters, props, searchState) {\n    if (Object.keys(props.trackedFilters).length === 0) {\n      return searchParameters;\n    }\n\n    var indexSearchState = hasMultipleIndices({\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    }) && searchState.indices ? searchState.indices[getIndexId({\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    })] : searchState;\n    var newRuleContexts = getRuleContextsFromTrackedFilters({\n      searchState: indexSearchState,\n      trackedFilters: props.trackedFilters\n    });\n    var initialRuleContexts = searchParameters.ruleContexts || [];\n    var nextRuleContexts = [].concat(_toConsumableArray(initialRuleContexts), _toConsumableArray(newRuleContexts));\n\n    if (process.env.NODE_ENV === 'development') {\n      if (nextRuleContexts.length > 10) {\n        // eslint-disable-next-line no-console\n        console.warn(\"The maximum number of `ruleContexts` is 10. They have been sliced to that limit.\\nConsider using `transformRuleContexts` to minimize the number of rules sent to Algolia.\");\n      }\n    }\n\n    var ruleContexts = props.transformRuleContexts(nextRuleContexts).slice(0, 10);\n    return searchParameters.setQueryParameter('ruleContexts', ruleContexts);\n  }\n});","map":{"version":3,"names":["_toConsumableArray","createConnector","getResults","getIndexId","hasMultipleIndices","escapeRuleContext","ruleName","replace","getWidgetRefinements","attribute","widgetKey","searchState","widgetState","Object","keys","map","rangeKey","split","getRefinements","arguments","length","undefined","refinements","filter","reduce","acc","current","concat","getRuleContextsFromTrackedFilters","_ref","trackedFilters","ruleContexts","facets","facetName","facetRefinements","getTrackedFacetValues","trackedFacetValues","facetRefinement","includes","facetValue","defaultProps","transformItems","items","transformRuleContexts","displayName","$$type","getProvidedProps","props","_1","searchResults","results","ais","contextValue","multiIndexContext","indexContextValue","canRefine","_results$userData","userData","transformedItems","getSearchParameters","searchParameters","indexSearchState","indices","newRuleContexts","initialRuleContexts","nextRuleContexts","process","env","NODE_ENV","console","warn","slice","setQueryParameter"],"sources":["/home/dedm/Documents/sript/lab3-script/node_modules/react-instantsearch-core/dist/es/connectors/connectQueryRules.js"],"sourcesContent":["import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport createConnector from \"../core/createConnector.js\";\nimport { getResults, getIndexId, hasMultipleIndices } from \"../core/indexUtils.js\";\n\n// A context rule must consist only of alphanumeric characters, hyphens, and underscores.\n// See https://www.algolia.com/doc/guides/managing-results/refine-results/merchandising-and-promoting/in-depth/implementing-query-rules/#context\nfunction escapeRuleContext(ruleName) {\n  return ruleName.replace(/[^a-z0-9-_]+/gi, '_');\n}\n\nfunction getWidgetRefinements(attribute, widgetKey, searchState) {\n  var widgetState = searchState[widgetKey];\n\n  switch (widgetKey) {\n    case 'range':\n      return Object.keys(widgetState[attribute]).map(function (rangeKey) {\n        return widgetState[attribute][rangeKey];\n      });\n\n    case 'refinementList':\n      return widgetState[attribute];\n\n    case 'hierarchicalMenu':\n      return [widgetState[attribute]];\n\n    case 'menu':\n      return [widgetState[attribute]];\n\n    case 'multiRange':\n      return widgetState[attribute].split(':');\n\n    case 'toggle':\n      return [widgetState[attribute]];\n\n    default:\n      return [];\n  }\n}\n\nfunction getRefinements(attribute) {\n  var searchState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var refinements = Object.keys(searchState).filter(function (widgetKey) {\n    return searchState[widgetKey] !== undefined && searchState[widgetKey][attribute] !== undefined;\n  }).map(function (widgetKey) {\n    return getWidgetRefinements(attribute, widgetKey, searchState);\n  }).reduce(function (acc, current) {\n    return acc.concat(current);\n  }, []); // flatten the refinements\n\n  return refinements;\n}\n\nfunction getRuleContextsFromTrackedFilters(_ref) {\n  var searchState = _ref.searchState,\n      trackedFilters = _ref.trackedFilters;\n  var ruleContexts = Object.keys(trackedFilters).reduce(function (facets, facetName) {\n    var facetRefinements = getRefinements(facetName, searchState);\n    var getTrackedFacetValues = trackedFilters[facetName];\n    var trackedFacetValues = getTrackedFacetValues(facetRefinements);\n    return [].concat(_toConsumableArray(facets), _toConsumableArray(facetRefinements.filter(function (facetRefinement) {\n      return trackedFacetValues.includes(facetRefinement);\n    }).map(function (facetValue) {\n      return escapeRuleContext(\"ais-\".concat(facetName, \"-\").concat(facetValue));\n    })));\n  }, []);\n  return ruleContexts;\n}\n\nvar defaultProps = {\n  transformItems: function transformItems(items) {\n    return items;\n  },\n  transformRuleContexts: function transformRuleContexts(ruleContexts) {\n    return ruleContexts;\n  },\n  trackedFilters: {}\n};\nexport default createConnector({\n  displayName: 'AlgoliaQueryRules',\n  $$type: 'ais.queryRules',\n  defaultProps: defaultProps,\n  getProvidedProps: function getProvidedProps(props, _1, searchResults) {\n    var results = getResults(searchResults, {\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    });\n\n    if (results === null) {\n      return {\n        items: [],\n        canRefine: false\n      };\n    }\n\n    var _results$userData = results.userData,\n        userData = _results$userData === void 0 ? [] : _results$userData;\n    var transformItems = props.transformItems;\n    var transformedItems = transformItems(userData);\n    return {\n      items: transformedItems,\n      canRefine: transformedItems.length > 0\n    };\n  },\n  getSearchParameters: function getSearchParameters(searchParameters, props, searchState) {\n    if (Object.keys(props.trackedFilters).length === 0) {\n      return searchParameters;\n    }\n\n    var indexSearchState = hasMultipleIndices({\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    }) && searchState.indices ? searchState.indices[getIndexId({\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    })] : searchState;\n    var newRuleContexts = getRuleContextsFromTrackedFilters({\n      searchState: indexSearchState,\n      trackedFilters: props.trackedFilters\n    });\n    var initialRuleContexts = searchParameters.ruleContexts || [];\n    var nextRuleContexts = [].concat(_toConsumableArray(initialRuleContexts), _toConsumableArray(newRuleContexts));\n\n    if (process.env.NODE_ENV === 'development') {\n      if (nextRuleContexts.length > 10) {\n        // eslint-disable-next-line no-console\n        console.warn(\"The maximum number of `ruleContexts` is 10. They have been sliced to that limit.\\nConsider using `transformRuleContexts` to minimize the number of rules sent to Algolia.\");\n      }\n    }\n\n    var ruleContexts = props.transformRuleContexts(nextRuleContexts).slice(0, 10);\n    return searchParameters.setQueryParameter('ruleContexts', ruleContexts);\n  }\n});"],"mappings":"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"},"metadata":{},"sourceType":"module"}